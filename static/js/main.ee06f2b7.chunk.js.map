{"version":3,"sources":["FirebaseInstance.js","FileSelector.js","ResultsView.js","App.js","serviceWorker.js","index.js"],"names":["config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","FirebaseInstance","firebase","apps","length","this","app","initializeApp","FileSelector","props","hasUnmounted","handleVotingCodes","event","file","codeFile","files","excelFile","storage","ref","child","alert","put","then","snapshot","getDownloadURL","url","setState","votingCodesFile","handleVotes","voteFile","votesFile","onClick","history","push","preventDefault","setCodeRef","setVoteRef","bind","className","type","React","Component","withUnmounted","Excel","require","ResultsView","state","votingResult","finalResults","resultsVisible","resultButtonVisible","isResultValid","voteLength","codeWorkbook","voteWorkbook","isFetched","calculateResults","resultList","resultButton","initCodeFile","initVoteFile","workbook","Workbook","fetch","result","blob","arrayBuffer","buffer","xlsx","load","catch","error","r√∂ven","codes","getWorksheet","getColumn","eachCell","content","text","slice","referenceCodes","previousVoters","getVotingCodes","getReferenceCodes","invalidCodes","forEach","code","includes","filter","x","columnHeaders","getRow","worksheet","electionVotes","getElections","i","actualColumnCount","cell","prop","startsWith","votes","shift","getVotes","results","vote","split","trim","console","log","countVotes","compareVotingCodes","array","objArray","Object","entries","finalResult","key","value","s","voteLengthCorrect","map","nextId","App","params","composeVoteView","composeFileView","basename","process","exact","from","to","style","role","aria-label","path","render","Boolean","window","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.ee06f2b7.chunk.js","sourcesContent":["import firebase from \"firebase\";\r\n\r\nconst config = {\r\n  apiKey: \"AIzaSyCQnGWPb9g0qVM-mYsuvC-MlbWztZBdtmw\",\r\n  authDomain: \"vg-voting-83c84.firebaseapp.com\",\r\n  databaseURL: \"https://vg-voting-83c84.firebaseio.com\",\r\n  projectId: \"vg-voting-83c84\",\r\n  storageBucket: \"vg-voting-83c84.appspot.com\",\r\n  messagingSenderId: \"14819118797\",\r\n  appId: \"1:14819118797:web:6a3006215809c1a8ffe384\"\r\n};\r\n\r\nclass FirebaseInstance {\r\n  constructor() {\r\n    !firebase.apps.length ? this.firebase = firebase.initializeApp(config) : this.firebase = firebase.app();\r\n  }\r\n}\r\nexport default FirebaseInstance;\r\n","import '@fortawesome/fontawesome-free/css/all.min.css';\r\nimport 'bootstrap-css-only/css/bootstrap.min.css';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport \"bootstrap/dist/js/bootstrap.js\";\r\nimport 'mdbreact/dist/css/mdb.css';\r\nimport React from 'react';\r\nimport FirebaseInstance from \"./FirebaseInstance\";\r\nimport withUnmounted from '@ishawnwang/withunmounted'\r\n\r\nclass FileSelector extends React.Component {\r\n    hasUnmounted = false;\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.setCodeRef = ref => {\r\n            this.codeFile = ref;\r\n        }\r\n\r\n        this.setVoteRef = ref => {\r\n            this.voteFile = ref;\r\n        }\r\n        this.firebase = new FirebaseInstance().firebase;\r\n        this.handleVotingCodes = this.handleVotingCodes.bind(this);\r\n        this.handleVotes = this.handleVotes.bind(this);\r\n        this.onClick = this.onClick.bind(this);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.setCodeRef = ref => {\r\n            this.codeFile = null;\r\n        }\r\n\r\n        this.setVoteRef = ref => {\r\n            this.voteFile = null;\r\n        }\r\n    }\r\n\r\n    handleVotingCodes = event => {\r\n        const file = this.codeFile.files[0];\r\n        const storageRef = this.firebase.storage().ref();\r\n        const excelFile = storageRef.child(\"voting_codes.xlsx\");\r\n\r\n        if (!file) {\r\n            alert(\"V√§lj en fil med r√∂stkoder.\")\r\n        }\r\n\r\n        excelFile.put(file).then((snapshot) => {\r\n            excelFile.getDownloadURL().then((url) => {\r\n                if (!this.hasUnmounted) {\r\n                    this.setState({\r\n                        votingCodesFile: url\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    handleVotes = event => {\r\n        const file = this.voteFile.files[0];\r\n        const storageRef = this.firebase.storage().ref();\r\n        const excelFile = storageRef.child(\"votes.xlsx\");\r\n\r\n        if (!file) {\r\n            alert(\"V√§lj en fil med r√∂ster.\")\r\n        }\r\n\r\n        excelFile.put(file).then((snapshot) => {\r\n            excelFile.getDownloadURL().then((url) => {\r\n                if (!this.hasUnmounted) {\r\n                    this.setState({\r\n                        votesFile: url\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    onClick = event => {\r\n        this.handleVotingCodes();\r\n        this.handleVotes();\r\n        this.props.history.push('/results');\r\n        event.preventDefault();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"container\">\r\n                <div>\r\n                    <div className=\"row justify-content-center\">\r\n                        <div className=\"ml-5 mr-2\">\r\n                            <h4>Ladda upp fil med r√∂stkoder</h4>\r\n                            <input type=\"file\" className=\"form-control-file\" ref={this.setCodeRef} />\r\n                        </div>\r\n                        <br></br>\r\n                        <div className=\"ml-4\">\r\n                            <h4>Ladda upp fil med r√∂ster</h4>\r\n                            <input type=\"file\" className=\"form-control-file\" ref={this.setVoteRef} />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br></br>\r\n                <div className=\"row\">\r\n                    <div className=\"col text-center\">\r\n                        <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.onClick}>Ladda upp</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withUnmounted(FileSelector);\r\n","import '@fortawesome/fontawesome-free/css/all.min.css';\r\nimport 'bootstrap-css-only/css/bootstrap.min.css';\r\nimport 'mdbreact/dist/css/mdb.css';\r\nimport React from \"react\";\r\nimport FirebaseInstance from \"./FirebaseInstance\";\r\nimport nextId from \"react-id-generator\";\r\nconst Excel = require('exceljs');\r\n\r\nclass ResultsView extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = ({ votingResult: [], finalResults: [], resultsVisible: false, resultButtonVisible: true, isResultValid: null, voteLength: 0, codeWorkbook: null, voteWorkbook: null, isFetched: false });\r\n\r\n        this.onClick = this.onClick.bind(this);\r\n        this.calculateResults = this.calculateResults.bind(this);\r\n        this.resultList = this.resultList.bind(this);\r\n        this.resultButton = this.resultButton.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.firebase = new FirebaseInstance().firebase;\r\n        this.initCodeFile();\r\n        this.initVoteFile();\r\n    }\r\n\r\n    initVoteFile() {\r\n        var workbook = new Excel.Workbook();\r\n        const storageRef = this.firebase.storage().ref();\r\n        storageRef.child('votes.xlsx').getDownloadURL().then(function (url) {\r\n            fetch(url).then(result => {\r\n                result.blob().then(file => {\r\n                    file.arrayBuffer().then(buffer => {\r\n                        workbook.xlsx.load(buffer);\r\n                    });\r\n                });\r\n            });\r\n        }).catch(function (error) {\r\n            alert(\"N√•got gick fel, f√∂rs√∂k igen!\" + error);\r\n        });\r\n        this.setState({ voteWorkbook: workbook }, this.r√∂ven);\r\n    }\r\n\r\n    initCodeFile() {\r\n        var workbook = new Excel.Workbook();\r\n        const storageRef = this.firebase.storage().ref();\r\n        storageRef.child('voting_codes.xlsx').getDownloadURL().then(function (url) {\r\n            fetch(url).then(result => {\r\n                result.blob().then(file => {\r\n                    file.arrayBuffer().then(buffer => {\r\n                        workbook.xlsx.load(buffer);\r\n                    });\r\n                });\r\n            });\r\n        }).catch(function (error) {\r\n            alert(\"N√•got gick fel, f√∂rs√∂k igen!\" + error);\r\n        });\r\n        this.setState({ codeWorkbook: workbook }, this.r√∂ven);\r\n    }\r\n\r\n    getVotingCodes() {\r\n        let codes = [];\r\n        const workbook = this.state.voteWorkbook;\r\n        workbook.getWorksheet().getColumn(\"B\").eachCell(content => codes.push(content.text));\r\n        return codes.slice(1);\r\n    }\r\n\r\n    getReferenceCodes() {\r\n        let referenceCodes = [];\r\n        const workbook = this.state.codeWorkbook;\r\n        workbook.getWorksheet().getColumn(\"A\").eachCell(content => referenceCodes.push(content.text));\r\n        return referenceCodes;\r\n    }\r\n\r\n    compareVotingCodes() {\r\n        let previousVoters = [];\r\n        let codes = this.getVotingCodes();\r\n        let referenceCodes = this.getReferenceCodes();\r\n        var result = [];\r\n        var invalidCodes = [];\r\n\r\n        codes.forEach(code => {\r\n            if (referenceCodes.includes(code)) {\r\n                previousVoters.push(code);\r\n                result.push(\"Giltig r√∂st: \" + code);\r\n                referenceCodes = referenceCodes.filter(x => x !== code);\r\n            } else if (previousVoters.includes(code)) {\r\n                invalidCodes.push(\"Ogiltig r√∂st, har r√∂stat mer √§n 1 g√•ng: \" + code);\r\n                this.setState({ isResultValid: false });\r\n            } else {\r\n                invalidCodes.push(\"Ogiltig r√∂st, ej registrerad: \" + code);\r\n                this.setState({ isResultValid: false });\r\n            }\r\n        });\r\n        if (invalidCodes.length === 0) {\r\n            this.setState({ isResultValid: true });\r\n        }\r\n        return [result, invalidCodes];\r\n    }\r\n\r\n    getElections() {\r\n        var columnHeaders = {};\r\n        const workbook = this.state.voteWorkbook;\r\n        workbook.getWorksheet().getRow(1).eachCell(content => {\r\n            if (content.text !== \"Tidst√§mpel\" && content.text !== \"Valkod\") {\r\n                columnHeaders[content.text] = [];\r\n            }\r\n        });\r\n        return columnHeaders;\r\n    }\r\n\r\n    getVotes() {\r\n        const workbook = this.state.voteWorkbook;\r\n        let worksheet = workbook.getWorksheet();\r\n        let electionVotes = this.getElections();\r\n        for (let i = 3; i <= worksheet.actualColumnCount; i++) {\r\n            worksheet.getColumn(i).eachCell(cell => {\r\n                for (let prop in electionVotes) {\r\n                    if (cell.text.startsWith(prop)) {\r\n                        let votes = electionVotes[prop];\r\n                        votes.push(cell.text);\r\n                        electionVotes[prop] = votes;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        for (let prop in electionVotes) {\r\n            electionVotes[prop].shift();\r\n        }\r\n        return electionVotes;\r\n    }\r\n\r\n    countVotes() {\r\n        const votes = this.getVotes();\r\n        const results = {};\r\n        for (let prop in votes) {\r\n            votes[prop].forEach(vote => {\r\n                vote = vote.split(\",\");\r\n                vote.forEach(vote => {\r\n                    results[vote.trim()] = (results[vote.trim()] + 1) || 1;\r\n                });\r\n            });\r\n        }\r\n        return results;\r\n    }\r\n\r\n    r√∂ven() {\r\n        console.log(this.state);\r\n    }\r\n\r\n    // --------------------------------------------------------------------------------------------------------------------------------------- //\r\n\r\n    onClick(event) {\r\n        this.props.history.push('/file-selector');\r\n        event.preventDefault();\r\n    }\r\n\r\n    calculateResults() {\r\n        var result = this.countVotes();\r\n        var votingResult = [];\r\n        this.compareVotingCodes().forEach(array => array.forEach(vote => votingResult.push(vote)));\r\n        var objArray = Object.entries(result);\r\n        var finalResult = [];\r\n\r\n        objArray.forEach(([key, value]) => {\r\n            if (value === 1) {\r\n                var s = \" r√∂st\"\r\n            } else {\r\n                s = \" r√∂ster\"\r\n            }\r\n            finalResult.push(key + \": \" + value + s);\r\n        });\r\n        this.setState({ votingResult: votingResult, finalResults: finalResult, resultsVisible: true, resultButtonVisible: false, voteLength: this.getReferenceCodes().length }, this.r√∂ven);\r\n    }\r\n\r\n    resultButton() {\r\n        return (\r\n            <div className=\"col text-center\">\r\n                <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.calculateResults}>Visa valresultat</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    resultList() {\r\n        var voteLengthCorrect = this.state.voteLength === this.state.votingResult.length\r\n\r\n        if (this.state.isResultValid && voteLengthCorrect) {\r\n            return (\r\n                <div className=\"container w-75\">\r\n                    <h1><b>Resultat</b></h1>\r\n                    <ul className=\"list-group\">\r\n                        {this.state.finalResults.map((result) =>\r\n                            <li key={nextId()} className=\"list-group-item\"> {<h3> {result}</h3>}</li>\r\n                        )\r\n                        }\r\n                    </ul>\r\n                    <br></br>\r\n                    <br></br>\r\n                    <br></br>\r\n                    <h1><b>R√∂stvalidering</b></h1>\r\n                    <br></br>\r\n                    <h3><b>Antal r√∂stande: {this.state.votingResult.length}</b></h3>\r\n                    <h3><b>R√∂stl√§ngd: {this.state.voteLength}</b></h3>\r\n                    <br></br>\r\n                    <ul className=\"list-group\">\r\n                        {this.state.votingResult.map((result) =>\r\n                            <li key={nextId()} className=\"list-group-item\"> {<h3> {result}</h3>}</li>\r\n                        )\r\n                        }\r\n                    </ul>\r\n\r\n                    <div className=\"col text-center\">\r\n                        <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.onClick}>Genomf√∂r en ny r√∂stning</button>\r\n                    </div>\r\n                </div >\r\n            );\r\n        } else if (this.state.isResultValid && !voteLengthCorrect) {\r\n            return (\r\n                <div className=\"container w-75\">\r\n                    <h5><b>R√∂stningen √§r inte giltig. R√∂stl√§ngd och antalet r√∂ster st√§mmer √∂verensst√§mmer inte.</b></h5>\r\n                    <br></br>\r\n                    <li className=\"list-group-item\">\r\n                        <h5>Antal r√∂stande: {this.state.votingResult.length}</h5>\r\n                        <h5>R√∂stl√§ngd: {this.state.voteLength}</h5>\r\n                    </li>\r\n                    <div className=\"col text-center\">\r\n                        <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.onClick}>Genomf√∂r en ny r√∂stning</button>\r\n                    </div>\r\n                </div >\r\n            );\r\n        }\r\n\r\n        else if (!this.state.isResultValid && voteLengthCorrect) {\r\n            return (\r\n                <div className=\"container w-75\">\r\n                    <h5><b>R√∂stningen √§r inte giltig. Ta bort ogiltiga r√∂ster ur Excel-arket och ladda upp igen: </b></h5>\r\n                    <br></br>\r\n                    <ul className=\"list-group\">\r\n                        {this.state.votingResult.map((result) =>\r\n                            <li key={nextId()} className=\"list-group-item\"> {<h3> {result}</h3>}</li>\r\n                        )\r\n                        }\r\n                    </ul>\r\n                    <div className=\"col text-center\">\r\n                        <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.onClick}>Genomf√∂r en ny r√∂stning</button>\r\n                    </div>\r\n                </div >\r\n            );\r\n        } else if (!this.state.isResultValid && !voteLengthCorrect) {\r\n            return (\r\n                <div className=\"container w-75\">\r\n                    <h5><b>R√∂stningen √§r inte giltig. Ta bort ogiltiga r√∂ster ur Excel-arket och ladda upp igen: </b></h5>\r\n                    <br></br>\r\n                    <ul className=\"list-group\">\r\n                        {this.state.votingResult.map((result) =>\r\n                            <li key={nextId()} className=\"list-group-item\"> {<h3> {result}</h3>}</li>\r\n                        )}\r\n                    </ul>\r\n                    <br></br>\r\n                    <h5><b>R√∂stningen √§r inte giltig. R√∂stl√§ngd och antalet r√∂ster st√§mmer √∂verensst√§mmer inte.</b></h5>\r\n                    <br></br>\r\n                    <li className=\"list-group-item\">\r\n                        <h5>Antal r√∂stande: {this.state.votingResult.length}</h5>\r\n                        <h5>R√∂stl√§ngd: {this.state.voteLength}</h5>\r\n                    </li>\r\n                    <div className=\"col text-center\">\r\n                        <button type=\"button\" className=\"btn btn-success m-4 btn-lg\" onClick={this.onClick}>Genomf√∂r en ny r√∂stning</button>\r\n                    </div>\r\n                </div >\r\n            );\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"container w-50\">\r\n                {this.state.resultsVisible ? this.resultList() : null}\r\n                <div className=\"row\">\r\n\r\n                </div>\r\n                {this.state.resultButtonVisible ? this.resultButton() : null}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ResultsView;","import React from 'react';\r\nimport '@fortawesome/fontawesome-free/css/all.min.css';\r\nimport 'bootstrap-css-only/css/bootstrap.min.css';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport \"bootstrap/dist/js/bootstrap.js\";\r\nimport 'mdbreact/dist/css/mdb.css'\r\nimport { BrowserRouter as Router, Route, Switch, Redirect } from \"react-router-dom\";\r\nimport FileSelector from \"./FileSelector\";\r\nimport ResultsView from \"./ResultsView\";\r\n\r\nclass App extends React.Component {\r\n  composeVoteView() {\r\n    return (params) => <ResultsView {...params} />;\r\n  }\r\n  composeFileView() {\r\n    return (params) => <FileSelector {...params} />;\r\n  } \r\n\r\n  render() {\r\n    const votes = this.composeVoteView();\r\n    const files = this.composeFileView();\r\n\r\n    return (\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <Switch>\r\n          <Redirect exact from=\"/voting-vg\" to=\"/file-selector\" />\r\n          <div>\r\n            <div className=\"jumbotron text-center\" style={{ \"paddingTop\": \"10px\", \"paddingBottom\": \"10px\" }}>\r\n              <div className=\"text-left\">\r\n                <span>Fr√•gor/support: david.jungermann@gmail.com</span>\r\n              </div>\r\n              <h1 className=\"display-4\"><span role=\"img\" aria-label=\"vote\">üó≥Ô∏è</span> R√∂str√§knare <span role=\"img\" aria-label=\"vote\">üó≥Ô∏è</span></h1>\r\n              <p className=\"lead\">V√§stg√∂ta Nation</p>\r\n            </div>\r\n            <div className=\"container w-50\">\r\n              <Route path=\"/file-selector\" render={files}></Route>\r\n            </div>\r\n            <div>\r\n              <Route path=\"/results\" render={votes}></Route>\r\n            </div>\r\n          </div>\r\n        </Switch>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"bootstrap/dist/css/bootstrap.css\";\r\nimport \"bootstrap/dist/js/bootstrap.js\";\r\nimport App from \"./App\";\r\nimport \"./styles.css\";\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n    <App />,\r\n    document.getElementById('root'));\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}